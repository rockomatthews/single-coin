import { NextRequest, NextResponse } from 'next/server'; import { Pool } from 'pg'; const pool = new Pool({ connectionString: process.env.DATABASE_URL, ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false }); export async function DELETE(request: NextRequest) { try { console.log('üßπ Starting cleanup of test data...'); const client = await pool.connect(); try { const result = await client.query(`DELETE FROM tokens WHERE name LIKE '%Test%' OR symbol LIKE '%TEST%' OR image LIKE '%test.com%' RETURNING *;`); console.log(`üóëÔ∏è Deleted ${result.rowCount} test tokens`); return NextResponse.json({ success: true, message: `Deleted ${result.rowCount} test tokens`, deletedTokens: result.rows }); } finally { client.release(); } } catch (error) { console.error('‚ùå Error cleaning up test data:', error); return NextResponse.json({ error: 'Failed to cleanup test data', details: error instanceof Error ? error.message : 'Unknown error' }, { status: 500 }); } }
